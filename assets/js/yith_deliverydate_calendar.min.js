jQuery(document).ready(function(e){function a(){$events_json=d.data("ywcdd_events_json"),d.fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},defaultDate:ywcdd_calendar_params.starday,editable:!1,eventLimit:!0,events:$events_json,eventRender:function(a,d,t){"holiday"==a.event_type&&(d.append("<span class='ywcdd_delete_calendar'></span>"),d.on("click",".ywcdd_delete_calendar",function(d){var t={ywcdd_event_id:a._id,action:ywcdd_calendar_params.actions.delete_holidays};e.ajax({type:"POST",url:ywcdd_calendar_params.ajax_url,data:t,dataType:"json",success:function(d){"deleted"===d.result&&e("#ywcdd_general_calendar").fullCalendar("removeEvents",a._id)}})})),d.find(".fc-title").html(d.find(".fc-title").text())}})}var d=e("#ywcdd_general_calendar"),t=e("#yith_datepicker_from"),n=e("#yith_datepicker_to"),c={message:null,overlayCSS:{background:"#fff",opacity:.6},ignoreIfBlocked:!0},i=function(){e(".how_holiday").select2("val",null),e("#yith_event_name").val(""),e("#yith_datepicker_from").val(""),e("#yith_datepicker_to").val("")};t.length&&t.datepicker({dateFormat:ywcdd_calendar_params.dateformat,defaultDate:"+1w",onClose:function(a){e("#yith_datepicker_to").datepicker("option","minDate",a)}}),n.length&&n.datepicker({dateFormat:ywcdd_calendar_params.dateformat,defaultDate:"+1w",onClose:function(a){e("#yith_datepicker_from").datepicker("option","maxDate",a)}}),d.length&&a(),e(".yith-wcdd-new-holiday-content").on("blur change","#yith_event_name, #yith_datepicker_from, #yith_datepicker_to",function(a){""==e(this).val()?e(this).addClass("ywcdd_required_field"):e(this).removeClass("ywcdd_required_field")}),e(".yith-wcdd-new-holiday-content").on("change",".how_holiday",function(a){var d=e(".how_holiday").select2("val");""==d?e("div.how_holiday>ul.select2-choices").addClass("ywcdd_required_field"):e("div.how_holiday>ul.select2-choices").removeClass("ywcdd_required_field")}),e(".yith-wcdd-new-holiday-content").on("click",".yith-add-new-holiday",function(t){t.preventDefault();var n=e(".how_holiday").select2("val"),l=e("#yith_event_name").val(),o=e("#yith_datepicker_from").val(),_=e("#yith_datepicker_to").val();if(e("select.how_holiday").change(),e("#yith_event_name").blur(),e("#yith_datepicker_from").blur(),e("#yith_datepicker_to").blur(),""!=n&&""!=l&&""!=o&&""!=_){e(".yith-wcdd-new-holiday-content").block(c);var r={ywcdd_add_holidays:"add_new_holidays",ywcdd_how_add:n,ywcdd_start_event:o,ywcdd_end_event:_,ywcdd_event_name:l,action:ywcdd_calendar_params.actions.add_holidays};e.ajax({type:"POST",url:ywcdd_calendar_params.ajax_url,data:r,dataType:"json",success:function(t){i();var n=t.result;d.data("ywcdd_events_json",n),d.fullCalendar("destroy"),a(),e(".yith-wcdd-new-holiday-content").unblock()}})}})});