jQuery(document).ready(function(e){var t=function(){return e(".shipping_method").length>1?e(".shipping_method:checked").val():e(".shipping_method").val()},d=function(t){var d=e(".ywcdd_shipping_date");d.val(t)},a=function(t){var d=e(".ywcdd_timeslot_content"),a=e("#ywcdd_timeslot"),i=e(".ywcdd_timeslot_info"),n=(e(".form-row-slot"),e(".ywcdd_timeslot_av"));a.find("option").not("[value='']").remove(),e.isEmptyObject(t)?(n.val("no"),d.hide(),i.hide()):(e.each(t,function(t,d){a.append(e("<option></option>").attr("value",t).html(d))}),d.show(),i.show(),n.val("yes")),a.val("").trigger("change")},i=function(t){var i=e(".ywcdd_timeslot_content");if(""!=t){var n=e("#ywcdd_carrier").val(),o=e(".form-row-slot"),s=e("#ywcdd_process_method");data={ywcdd_carrier_id:n,ywcdd_date_selected:t,ywcdd_process_method:s.length?s.val():"",action:ywcdd_params.actions.update_timeslot},i.show(),o.hide(),_.block(c),e.ajax({type:"POST",url:ywcdd_params.ajax_url,data:data,dataType:"json",success:function(e){var t=e.available_timeslot;a(t),d(e.shipping_date),_.unblock(),r()}})}else i.hide()},n=function(t){if(date_picker_content=e(".ywcdd_datepicker_content"),datepicker=e("#ywcdd_datepicker"),date_picker_info_content=e(".ywcdd_info_content"),""!=t){var i=e("#ywcdd_process_method").val(),n=date_picker_info_content.find(".ywcdd_message");data={ywcdd_carrier_id:t,ywcdd_process_id:i,action:ywcdd_params.actions.update_datepicker},date_picker_content.hide(),date_picker_info_content.hide(),_.block(c),e.ajax({type:"POST",url:ywcdd_params.ajax_url,data:data,dataType:"json",success:function(e){if("undefined"!=typeof e.available_days){var t=e.available_days;datepicker.data("available_days",t);var i=0,o=0;t.length>0&&(i=t[0],o=t[t.length-1]),datepicker.datepicker("option","minDate",i),datepicker.datepicker("option","maxDate",o),datepicker.datepicker("setDate",i),a(e.available_timeslot),d(e.shipping_date),n.html(e.message),date_picker_info_content.show(),_.unblock(),r()}}})}else{date_picker_info_content.hide(),date_picker_content.hide(),datepicker.val("");var s=e("#ywcdd_timeslot");s.find("option").not("[value='']").remove(),s.val("").trigger("change")}o()},o=function(){var t=e(".ywcdd_timeslot_content"),d=e(".form-row-slot");t.hide(),d.hide()},c={message:null,overlayCSS:{background:"#fff",opacity:.6},ignoreIfBlocked:!0},r=function(){if("yes"==ywcdd_params.open_datepicker){var t=e(document).find(".ywcdd_info_content"),d=t.parent().find(".ywcdd_datepicker_content");t.hide(),d.show("slow");var t=e(document).find(".ywcdd_timeslot_info"),a=t.parent().find(".form-row-slot");t.hide(),a.show("slow")}},_=e("div.ywcdd_select_delivery_date_content"),s=t();e(document).on("init-delivery-fields",function(t){var d=e("#ywcdd_datepicker"),a=e("#ywcdd_carrier");if(d.length){var o=d.data("available_days");d.datepicker({dateFormat:ywcdd_params.dateformat,numberOfMonths:1*ywcdd_params.numberOfMonths,beforeShow:function(t,d){e("#ui-datepicker-div").removeClass("yith_datepicker"),e("#ui-datepicker-div").addClass("yith_datepicker"),setTimeout(function(){e("#ui-datepicker-div").show()},0)},beforeShowDay:function(t){var d=e(this).data("available_days"),a=e.datepicker.formatDate("yy-mm-dd",t);return[-1!=d.indexOf(a)]},onClose:function(t,d){i(t),e("#ui-datepicker-div").hide(),e("#ui-datepicker-div").unwrap()}}),"undefined"!=typeof o&&o.length>0&&(min=o[0],max=o[o.length-1],d.datepicker("option","minDate",min),d.datepicker("option","maxDate",max),d.datepicker("setDate",min),i(min))}if(a.length&&(a.on("change",function(t){var d=e(this).val();n(d)}),a.is("input"))){var c=a.val();-1!=c&&n(c)}}).trigger("init-delivery-fields"),e("form.checkout").on("change","#ywcdd_timeslot",function(t){e("body").trigger("update_checkout")}).on("click",".ywcdd_edit_date",function(t){t.preventDefault();var d=e(this).parents(".ywcdd_info_content"),a=d.parent().find(".ywcdd_datepicker_content");d.hide("slow"),a.show("slow")}).on("click",".ywcdd_show_timeslot",function(t){t.preventDefault();var d=e(this).parents(".ywcdd_timeslot_info"),a=d.parent().find(".form-row-slot");d.hide("slow"),a.show("slow")}),e("body").on("updated_checkout",function(d){var a=t(),i=e("#ywcdd_process_method");""!=a&&s!=a&&(data={ywcdd_update_carrier:"update_carrier",ywcdd_shipping_id:a,ywcdd_process_method:i.val(),action:ywcdd_params.actions.update_carrier_list},s=a,e.ajax({type:"POST",url:ywcdd_params.ajax_url,data:data,dataType:"json",success:function(t){t.update_delivery_form&&(e(".ywcdd_select_delivery_date_content").html(t.template),e("body").trigger("init-delivery-fields"))}}))})});